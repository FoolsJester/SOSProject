

<html>
<style>
    #head{
        background-color: darkcyan;
        height: 5%;
        width: 100%;
    }
    canvas{
        width: 600px !important;
    }

    #chartH{
        width: 600px;
        text-align:center;
        position: absolute;
        bottom: 0%;
        left: 7.5%;
        background-color: #ffffff;
        border-top-left-radius: 25px;
        border-top-right-radius: 25px;
        transition-duration: 0.5s;
    }

    #chartB{
        position: absolute;
        bottom: 0%;
        left: 7.5%;
        background-color: #ffffff;
    }
    #chartA{
        width: 600px;
        text-align:center;
        position: absolute;
        Bottom: 0%;
        left: 47.5%;
        background-color: #ffffff;
        border-top-left-radius: 25px;
        border-top-right-radius: 25px;
        transition-duration: 0.5s;
    }

    #chartC{
        position: absolute;
        bottom: 0%;
        left: 47.5%;
        background-color: #ffffff;
    }
    .chart{
        transition: 0.5s;
        height: 0;
    }
</style>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <div id=head><center>Where's me bleedin' bike?!?</center><select id="daySelect">
  <option value="Monday">Monday
  <option value="Tuesday">Tuesday
  <option value="Wednesday">Wednesday
  <option value="Thursday">Thursday
  <option value="Friday">Friday
  <option value="Saturday">Saturday
  <option value="Sunday">Sunday
</select></div>
    <div id="map" style="width:100%;height:95%"></div>
    <span id="chartH" onclick="showHide()">&#9776; Show Graph</span>
    <div id="chartB" class="chart">
    <div id="graph"><div>
</div></div>
    </div>
    <span id="chartA" onclick="showHide1()">&#9776; Show Graph</span>
    <div id="chartC" class="chart">
    <div id="graph1"><div>
</div></div>
    </div>
</body>
<script>
    function myMap() {
    var mapOptions = {
        center: new google.maps.LatLng(53.346521, -6.259077),
        zoom: 14.175,
        mapTypeId: google.maps.MapTypeId.roadmap
    };

    var map = new google.maps.Map(document.getElementById("map"), mapOptions);
    standInfo = null;
    function availableBikes(data){
        $.getJSON("root3.json", function(root3){
           standInfo = root3.root3;
        })
    }
    availableBikes();
    function newMarkers(data){
        $.getJSON("root1.json", function(root1){
            var stations = root1.root1;
            for (i in stations) {
                var lati = stations[i].lat;
                var long = stations[i].lng;
                var name = stations[i].address;
                var number = stations[i].number;
                var bikes = standInfo[i].a_bikes;
                var stands = standInfo[i].stands;
                var info = "<h3><b>"+number+":</b> "+name+"</h3>"+
                            "<div><b>Available bikes: </b>"+bikes+"</div>"+
                            "<div><b>Available stands: </b>"+stands+"</div>" +
                    "<div><button onclick='avgBikes("+number+")'>Show chart hourly averages</button></div>" + "<div><button onclick='avgBikesDay("+number+")'>Show chart daily averages</button></div>";
                var infoWindow = new google.maps.InfoWindow({});
                var marker = new google.maps.Marker({
                    position: {lat: lati, lng: long},
                    title: name
                });
                marker.content = info;
                marker.addListener('click', function() {
                    var graphhtml = this.content;
                    var graphnum = graphhtml.substring(7, 9);
                    infoWindow.setContent(this.content)
                    infoWindow.open(map, this);
                });
                marker.setMap(map);
            }
    });
    }
    newMarkers();
}   

    var showGraph = false;
    function showHide() {
        if (showGraph == false){
            document.getElementById('chartB').style.height = "300px";
            document.getElementById('chartH').style.height = "320px";
            document.getElementById('chartH').innerHTML = "&#9776; Hide Graph";
            showGraph = true;
        } else {
            document.getElementById('chartB').style.height = "0px";
            document.getElementById('chartH').style.height = "Initial";
            document.getElementById('chartH').innerHTML = "&#9776; Show Graph";
            showGraph =false;
        }
    }
        var showGraph1 = false;
    function showHide1() {
        if (showGraph == false){
            document.getElementById('chartC').style.height = "300px";
            document.getElementById('chartA').style.height = "320px";
            document.getElementById('chartA').innerHTML = "&#9776; Hide Graph";
            showGraph = true;
        } else {
            document.getElementById('chartC').style.height = "0px";
            document.getElementById('chartA').style.height = "Initial";
            document.getElementById('chartA').innerHTML = "&#9776; Show Graph";
            showGraph =false;
        }
    }
    function avgBikes(num){
    $.getJSON("root4.json", function(root4){
            avgInfo = root4.root4;
            var ava_bikes =[];
            var numint = parseInt(num) - 1;
            var names = ["Clarendon Row","Blessington Street","Bolton Street","Greek Street","Charlemont Street","Christchurch Place","High Street","Custom House Quay","Exchequer Street","Dame Street","Earlsfort Terrace","Eccles Street","Fitzwilliam Square West","Fownes Street Upper","Hardwicke Street","Georges Quay","Golden Lane","Grantham Street","Herbert Place","","Leinster Street South","Townsend Street","Custom House","Cathal Brugha Street","Merrion Square East","Merrion Square West","Molesworth Street","Mountjoy Square West","Ormond Quay Upper","Parnell Square North","Parnell Street","Pearse Street","Princes Street / O'Connell Street","Portobello Harbour","Smithfield","St. Stephen's Green East","St. Stephen's Green South","Talbot Street","Wilton Terrace","Jervis Street","Harcourt Terrace","Smithfield North","Portobello Road","Upper Sherrard Street","Deverell Place","Strand Street Great","Herbert Street","Excise Walk","Guild Street","George's Lane","York Street West","York Street East","Newman House","Clonmel Street","Hatch Street","Mount Street Lower","Grattan Street","Sir Patrick's Dun","Denmark Street Great","North Circular Road","Hardwicke Place","Lime Street","Fenian Street","Sandwith Street","Convention Centre","New Central Bank","The Point","Hanover Quay","Grand Canal Dock","Barrow Street","Kevin Street","John Street West","Francis Street","Oliver Bond Street","James Street","Market Street South","Wolfe Tone Street","Mater Hospital","Eccles Street East","St James Hospital (Luas)","St. James Hospital (Central)","Mount Brown","Emmet Road","Brookfield Road","Rothe Abbey","Parkgate Street","Collins Barracks Museum","Blackhall Place","Fitzwilliam Square East","Benson Street","South Dock Road","Heuston Bridge (North)","Heuston Station (Central)","Heuston Station (Car Park)","Royal Hospital","Kilmainham Lane","Kilmainham Gaol","Frederick Street South","City Quay","Heuston Bridge (South)","King Street North","Western Way","Grangegorman Lower (South)","Grangegorman Lower (Central)","Grangegorman Lower (North)"];
            var ava_stands = [];
            var time = [];
            var x = 0;
            var day = document.getElementById("daySelect").value;
            while (x <= 23) {
                for (i in avgInfo){
                    var y = 0;
                    var ystr = x.toString();
                    if (avgInfo[i].number == num && avgInfo[i].weekday == day && avgInfo[i].hour == ystr){
                        ava_bikes.push(avgInfo[i].a_bikes);
                        ava_stands.push(avgInfo[i].a_stands);
                        }
                    y++;
                }
                x++;
            }
            var create_canvas = document.createElement("canvas");
            var ctx = create_canvas.getContext("2d");
            div = document.getElementById("graph"); 
            div.replaceChild(create_canvas, div.childNodes[0]);
            var lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                labels: ["12am","1am","2am","3am","4am","5am","6am","7am","8am","9am","10am","11am","12pm","1pm","2pm","3pm","4pm","5pm","6pm","7pm","8pm","9pm","10pm","11pm"],
                datasets: [{ 
                    data: ava_bikes,
                    label: "Average free bikes",
                    borderColor: "#3e95cd",
                    fill: false
                },
                { 
                    data: ava_stands,
                    label: "Average free stands",
                    borderColor: "#8e5ea2",
                    fill: false
                }]
                },
                options: {
                    title: {
                        display: true,
                        text: names[numint] + ': '+ day,
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
        });
    }
    
    
function avgBikesDay(num1){
    $.getJSON("root7.json", function(root7){
       avgInfoDay = root7.root7;
       var ava_bikes_day =[];
       var numint1 = parseInt(num1) - 1;
       var names = ["Clarendon Row","Blessington Street","Bolton Street","Greek Street","Charlemont Street","Christchurch Place","High Street","Custom House Quay","Exchequer Street","Dame Street","Earlsfort Terrace","Eccles Street","Fitzwilliam Square West","Fownes Street Upper","Hardwicke Street","Georges Quay","Golden Lane","Grantham Street","Herbert Place","","Leinster Street South","Townsend Street","Custom House","Cathal Brugha Street","Merrion Square East","Merrion Square West","Molesworth Street","Mountjoy Square West","Ormond Quay Upper","Parnell Square North","Parnell Street","Pearse Street","Princes Street / O'Connell Street","Portobello Harbour","Smithfield","St. Stephen's Green East","St. Stephen's Green South","Talbot Street","Wilton Terrace","Jervis Street","Harcourt Terrace","Smithfield North","Portobello Road","Upper Sherrard Street","Deverell Place","Strand Street Great","Herbert Street","Excise Walk","Guild Street","George's Lane","York Street West","York Street East","Newman House","Clonmel Street","Hatch Street","Mount Street Lower","Grattan Street","Sir Patrick's Dun","Denmark Street Great","North Circular Road","Hardwicke Place","Lime Street","Fenian Street","Sandwith Street","Convention Centre","New Central Bank","The Point","Hanover Quay","Grand Canal Dock","Barrow Street","Kevin Street","John Street West","Francis Street","Oliver Bond Street","James Street","Market Street South","Wolfe Tone Street","Mater Hospital","Eccles Street East","St James Hospital (Luas)","St. James Hospital (Central)","Mount Brown","Emmet Road","Brookfield Road","Rothe Abbey","Parkgate Street","Collins Barracks Museum","Blackhall Place","Fitzwilliam Square East","Benson Street","South Dock Road","Heuston Bridge (North)","Heuston Station (Central)","Heuston Station (Car Park)","Royal Hospital","Kilmainham Lane","Kilmainham Gaol","Frederick Street South","City Quay","Heuston Bridge (South)","King Street North","Western Way","Grangegorman Lower (South)","Grangegorman Lower (Central)","Grangegorman Lower (North)"];
       var ava_stands_day = [];
        console.log(ava_stands_day)

    function dailyBikesAvg(day){
        for (j in avgInfoDay){
            if (avgInfoDay[j].number == num1 && avgInfoDay[j].weekday == day){
                ava_bikes_day.push(avgInfoDay[j].a_bikes);
                ava_stands_day.push(avgInfoDay[j].a_stands);
                }}
    };
    dailyBikesAvg("Monday");
    dailyBikesAvg("Tuesday");
    dailyBikesAvg("Wednesday");
    dailyBikesAvg("Thursday");
    dailyBikesAvg("Friday");
    dailyBikesAvg("Saturday");
    dailyBikesAvg("Sunday");
      
var create_canvas = document.createElement("canvas");
var ctx = create_canvas.getContext("2d");
div = document.getElementById("graph1"); 
div.replaceChild(create_canvas, div.childNodes[0]);
var lineChart = new Chart(ctx, {
 type: 'line',
    data: {
    labels: ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],
    datasets: [{ 
        data: ava_bikes_day,
        label: "Average free bikes",
        borderColor: "#3e95cd",
        fill: false
      },
    { 
        data: ava_stands_day,
        label: "Average free stands",
        borderColor: "#8e5ea2",
        fill: false
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: names[numint1],
    },
    scales: {
      yAxes: [{
          ticks: {
              beginAtZero: true
          }
      }]
  }
  }
});
 });
    }
    </script>
<script src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyB3UCB640zi7tQblqiBA0JhFN0g057f81I&callback=myMap"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
</html>